<!DOCTYPE html>
	<html lang="en">
		<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22256%22 height=%22256%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2220%22 fill=%22%23d8eaeb%22></rect><text x=%2250%%22 y=%2250%%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 font-size=%2293%22>üå≥</text></svg>" />
            <title>FuzzyWuzzy: How to Measure String Distance in Python</title>
			<link rel="canonical" href="https://strikingloo.github.io/fuzzywuzzy-python-string-distance">
			  <meta name="description" content="Fuzzy string matching and string similarity. This is how FuzzyWuzzy works and how you can use it.">
  			<meta property="og:site_name" content="FuzzyWuzzy: How to Measure String Distance in Python">

        	
        	<link rel="stylesheet" type="text/css" href="/css/post-min.css">
        	

			<script async src="https://www.googletagmanager.com/gtag/js?id=UA-52642322-5"></script>

			<script>
			  window.dataLayer = window.dataLayer || [];
			  function gtag(){dataLayer.push(arguments);}
			  gtag('js', new Date());

			  gtag('config', 'UA-52642322-5');
			</script>
			
			  <meta property="og:description" content="Fuzzy string matching and string similarity. This is how FuzzyWuzzy works and how you can use it.">
			
	  		<meta property="og:locale" content="en_US">
	  		
			  <meta property="og:title" content="FuzzyWuzzy: How to Measure String Distance in Python">
			  <meta property="og:type" content="article">
		  	  <meta property="article:published_time" content="2019-04-15T00:00:00+00:00">
		      <meta property="article:author" content="/">
		  	
		  	
  				<meta property="og:url" content="https://strikingloo.github.io/fuzzywuzzy-python-string-distance">
  			
  			<meta content="index,follow" name="robots"><!-- All Search Engines -->
  			<meta content="index,follow" name="googlebot"><!-- Google Specific -->
  			<meta name="robots" content="max-image-preview:large">

		</head>
		<body>
			<div class="head-banner">
			<p>Strikingloo</p>
			<nav>
	    		<ul>
	        		<li><a href="/">Home</a></li>
		        	<li><a href="/about/">About</a></li>
	        		<li><a href="/wiki/">Wiki</a></li>
	        		<li><a href="/blog/">Blog </a></li>
	    		</ul>
			</nav>
			<div style="clear: both;"></div>
		    </div>

			<div class="container">
			
			<h1>FuzzyWuzzy: How to Measure String Distance in Python</h1>
<p class="meta">15 Apr 2019 - importance: 5 </p>




<div class="post">
  <p><em>Note: I originally wrote this article on my first blog, so it is not as polished as newer things.</em></p>

<p>Python‚Äôs <em>FuzzyWuzzy</em> library is used for measuring the similarity between two strings. Here‚Äôs how you can start using it too.</p>

<p>Sometimes, we need to see whether two strings are the same. When comparing an entered password‚Äôs hash to the one stored in your login database, ‚Äòsimilarity‚Äô just won‚Äôt cut it.</p>

<p>Other times, however, things can get a bit‚Ä¶ <em>fuzzier</em>.</p>

<p>If my customer‚Äôs name is <em>Albert Thompson</em>, but he pays with a Credit Card under the name of <em>Albert G. Thompson</em>, should I be calling the police to report fraud? Should ‚ÄúThe Lord of the Rings II: The Two Towers‚Äù and ‚ÄúThe Lord of the Rings 2: the 2 Towers‚Äù be treated as two completely separate books by a website? Are Austria and Australia really two different countries?</p>

<p>Okay, I may have gotten carried away with that last one, but you get the idea.</p>

<h2 id="string-distance-measures">String distance measures</h2>

<p>What we want is some function that measures how similar two strings are, but is robust to small changes. This problem is as common as it sounds: scientists have been coming up with solutions to it for a long while.</p>

<h3 id="jaccard-distance-a-first-approach">Jaccard Distance: a first approach</h3>

<p>One of the most intuitive ones is the Jaccard distance. It can be generalized to a distance measure for any two sets. It has the following formula:</p>

<p><img src="/resources/post_image/fuzzywuzzy1.svg" alt="" /></p>

<p>That is, how many elements are on either set, but not shared by both, divided by the total count of distinct elements.</p>

<p>For instance, given the strings ‚ÄúAlbert‚Äù and ‚ÄúAlberto‚Äù, it will report a similarity of 85.7%, since they share 6 letters out of a total of 7.</p>

<p>However, this is not a measure specifically tailored for strings.</p>

<p>It will fail in many use-cases, since it doesn‚Äôt really take ordering into account. For example two anagrams, like ‚Äúrail safety‚Äù and ‚Äúfairy tales‚Äù, will always have a 100% match, even if those strings are quite different.</p>

<h3 id="levenshtein-distance">Levenshtein Distance</h3>

<p>Invented by the Russian Scientist Vladimir Levenshtein in the ‚Äô60s, this measure is a bit more intuitive: it counts how many substitutions are needed, given a string <em>u</em>, to transform it into <em>v</em>.</p>

<p>For this method, a substitution is defined as:</p>

<ul>
  <li>Erasing a character.</li>
  <li>Adding one.</li>
  <li>Replacing a character with another one.</li>
</ul>

<p>The minimum amount of these operations that need to be done to <em>u</em> in order to turn it into <em>v,</em> correspond to the Levenshtein distance between those two strings.</p>

<p>It can be obtained recursively with this formula:</p>

<p><img src="/resources/post_image/fuzzywuzzy2.svg" alt="" /></p>

<p>Where <em>i</em> and <em>j</em> are indexes to the last character of the substring we‚Äôll be comparing. The second term in the last expression is equal to 1 if those characters are different, and 0 if they‚Äôre the same.</p>

<p>This is the measure Python‚Äôs FuzzyWuzzy library uses.</p>

<h2 id="using-fuzzywuzzy-in-python">Using FuzzyWuzzy in Python</h2>

<p>To obtain the similarity ratio between two strings, all we have to do is this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from fuzzywuzzy import fuzz
similarity = fuzz.ratio("hello","world")
</code></pre></div></div>

<p>You probably noticed I said ratio. The ratio method will always return a number between 0 and 100 (yeah, I‚Äôd have preferred it to be between 0 and 1, or call it a percentage, but to each their own).</p>

<p>It can be shown that the Levenshtein distance is at most the length of the longest string: replace all characters in the shorter one with the first part of the longer one, and then add the remaining ones.</p>

<p>That‚Äôs how we can normalize the distance to return a ratio, so that the number won‚Äôt fluctuate enormously given inputs with different sizes.</p>

<p>This solves some of the previously mentioned problems:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuzz.ratio("Albert Thompson", "Albert G. Thompson") #91%

fuzz.ratio("The Lord of the Rings II: The Two Towers",
 "The Lord of the Rings 2: the 2 Towers") #88%
</code></pre></div></div>

<p>Even if it may bring a few new ones:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#88% for two different countries
fuzz.ratio("Austria","Australia")

#57% but it's the same country
fuzz.ratio("Czechia","Czech Republic")
</code></pre></div></div>

<h2 id="other-fuzzywuzzy-methods">Other FuzzyWuzzy methods</h2>

<p>Python‚Äôs FuzzyWuzzy library provides us not only with the vanilla Levenshtein distance, but also with a few other methods we can make use of.</p>

<h3 id="partial_ratio">partial_ratio</h3>

<p>The <em>partial_ratio</em> method calculates the FuzzyWuzzy ratio for all substrings of the longer string with the length of the shorter one, and then returns the highest match.</p>

<p>For instance,</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuzz.partial_ratio("abc","a") == 
min([fuzz.ratio( char, "a") for char in "abc"])
</code></pre></div></div>

<p>This has some interesting effects:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuzz.partial_ratio("Thomas and His Friends", "Thomas") #100%
fuzz.partial_ratio("Batman vs Superman", "Batman") #100%
</code></pre></div></div>

<p>Effectively, the partial_ratio method could be a fuzzy replacement to the <em>contains</em> string method, just as the regular ratio may replace the <em>equals</em> method.</p>

<p>However, it will fail for strings that are similar, but whose words appear in a different order. Even a slight order change will break it.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#72% with basically the same idea
fuzz.partial_ratio("Peanut Butter and Jelly",
 "Jelly and Peanut Butter") 

#86% with a random (carefully selected) string
fuzz.partial_ratio("Peanut Butter and Jelly",
 "Otter and Hell")
</code></pre></div></div>

<h3 id="token_sort_ratio">token_sort_ratio</h3>

<p>The Token Sort Ratio divides both strings into words, then joins those again alphanumerically, before calling the regular ratio on them.</p>

<p>This means:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuzz.partial_ratio("Batman vs Superman", 
 "Superman vs Batman") #100%

fuzz.partial_ratio("a b c", "c b a") #100%
</code></pre></div></div>

<h3 id="token_set_ratio">token_set_ratio</h3>

<p>The Token Set Ratio separates each string into words, turns both lists into sets (discarding repeated words) and then sorts those before doing the ratio.</p>

<p>This way not only do we rule out shared words, we also account for repetitions.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fuzz.token_set_ratio("fun","fun fun fun") #100%

fuzz.token_set_ratio("Lord the Rings of",
 "Lord of the Rings") #100%
</code></pre></div></div>

<h2 id="conclusions">Conclusions</h2>

<p>Python‚Äôs FuzzyWuzzy library can be a useful tool to have under your belt. Both for customer‚Äôs names matching, or acting as a poor man‚Äôs word embedding, it can save you a lot of trouble or help with your Machine Learning model‚Äôs feature engineering.</p>

<p>However, since it requires preprocessing (like turning both strings to lowercase) and doesn‚Äôt take synonyms into account, it may not be the best solution for cases where actual NLP or <a href="/wiki/clustering">Clustering methods</a> may be needed.</p>

<p>I hope you‚Äôve found this article helpful, and let me know if you find another use for FuzzyWuzzy in your job.</p>

<p><em>Follow me on</em> <a href="http://www.twitter.com/strikingloo"><em>Twitter</em></a> to stay up to date with more Python tutorials, tips and tricks._</p>

<p><em>If you found this article useful, please consider sharing it on social media.</em></p>

<p><em>For other programming notes and articles, visit the <a href="/tagged?q=programming">programming tag page</a>.</em></p>

</div>
<a href='https://ko-fi.com/R6R3F4NIO' target='_blank' rel="noopener noreferrer nofollow">
  <img style='border:0px;height:4em;width:auto;' src='https://cdn.ko-fi.com/cdn/kofi5.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' loading='lazy'/></a>
  <p style='text-align: center;'>
  <a href="https://twitter.com/intent/tweet?text=FuzzyWuzzy: How to Measure String Distance in Python&url=https://strikingloo.github.io/fuzzywuzzy-python-string-distance%2F%3Futm_source%3Dtwitter%26utm_medium%3Dsocial&via=strikingLoo" title="Share on Twitter!">[<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 310 310" height="1em" width="1em" rel="noopener noreferrer nofollow"><path fill="#1DA1F2" d="M302.973 57.388a117.512 117.512 0 01-14.993 5.463 66.276 66.276 0 0013.494-23.73 5 5 0 00-7.313-5.824 117.994 117.994 0 01-34.878 13.783c-12.381-12.098-29.197-18.983-46.581-18.983-36.695 0-66.549 29.853-66.549 66.547 0 2.89.183 5.764.545 8.598C101.163 99.244 58.83 76.863 29.76 41.204a5.001 5.001 0 00-8.196.642c-5.896 10.117-9.013 21.688-9.013 33.461 0 16.035 5.725 31.249 15.838 43.137a56.37 56.37 0 01-8.907-3.977 5 5 0 00-7.427 4.257c-.007.295-.007.59-.007.889 0 23.935 12.882 45.484 32.577 57.229a57.372 57.372 0 01-5.063-.735 4.998 4.998 0 00-5.699 6.437c7.29 22.76 26.059 39.501 48.749 44.605-18.819 11.787-40.34 17.961-62.932 17.961a120.4 120.4 0 01-14.095-.826 5 5 0 00-3.286 9.174c29.023 18.609 62.582 28.445 97.047 28.445 67.754 0 110.139-31.95 133.764-58.753 29.46-33.421 46.356-77.658 46.356-121.367 0-1.826-.028-3.67-.084-5.508 11.623-8.757 21.63-19.355 29.773-31.536a5 5 0 00-6.182-7.351z"></path></svg>Share on twitter]</a></p>

<template id="post-delayed-content">

<div class="backButton">
<a href="https://twitter.com/intent/tweet?text=FuzzyWuzzy: How to Measure String Distance in Python&url=https://strikingloo.github.io/fuzzywuzzy-python-string-distance%2F%3Futm_source%3Dtwitter%26utm_medium%3Dsocial&via=strikingLoo" id='tweetThis' title="Share on Twitter!" rel="noopener noreferrer nofollow">[<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 310 310" height="1em" width="1em"><path fill="#1DA1F2" d="M302.973 57.388a117.512 117.512 0 01-14.993 5.463 66.276 66.276 0 0013.494-23.73 5 5 0 00-7.313-5.824 117.994 117.994 0 01-34.878 13.783c-12.381-12.098-29.197-18.983-46.581-18.983-36.695 0-66.549 29.853-66.549 66.547 0 2.89.183 5.764.545 8.598C101.163 99.244 58.83 76.863 29.76 41.204a5.001 5.001 0 00-8.196.642c-5.896 10.117-9.013 21.688-9.013 33.461 0 16.035 5.725 31.249 15.838 43.137a56.37 56.37 0 01-8.907-3.977 5 5 0 00-7.427 4.257c-.007.295-.007.59-.007.889 0 23.935 12.882 45.484 32.577 57.229a57.372 57.372 0 01-5.063-.735 4.998 4.998 0 00-5.699 6.437c7.29 22.76 26.059 39.501 48.749 44.605-18.819 11.787-40.34 17.961-62.932 17.961a120.4 120.4 0 01-14.095-.826 5 5 0 00-3.286 9.174c29.023 18.609 62.582 28.445 97.047 28.445 67.754 0 110.139-31.95 133.764-58.753 29.46-33.421 46.356-77.658 46.356-121.367 0-1.826-.028-3.67-.084-5.508 11.623-8.757 21.63-19.355 29.773-31.536a5 5 0 00-6.182-7.351z"></path></svg>]</a>
<br/>
<a href="/blog/" id='backToBlog' title="Back to blog" rel="noopener noreferrer">[‚Üê]</a>
</div>
</template>
<script>
const headings = document.querySelectorAll('h2[id],h3[id]');
for (var heading of headings) {
    heading.innerHTML = `<a href=#${heading.id}>${heading.innerHTML}</a>`;
}
function externalLinks() { for(var c = document.getElementsByTagName("a"), a = 0;a < c.length;a++) { var b = c[a]; b.getAttribute("href") && b.hostname !== location.hostname && (b.target = "_blank") } }
externalLinks();

function renderBottomButtons(){
  const templateNode = document.getElementById('post-delayed-content')
  const templateContentClone = templateNode.content.cloneNode(true) // perform a deep copy
  document.body.appendChild(templateContentClone)
}

function scrollEventHandler(){
 const scrollOffset = window.pageYOffset
 const browserViewHeight = window.innerHeight
 if (scrollOffset > browserViewHeight/3) {
    console.log('done')
    renderBottomButtons();
    window.removeEventListener('scroll', scrollEventHandler)
 }
}
window.addEventListener('scroll', scrollEventHandler)
</script>

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@StrikingLoo" />
<meta name="twitter:title" content="FuzzyWuzzy: How to Measure String Distance in Python" />
<meta name="twitter:description" content="Fuzzy string matching and string similarity. This is how FuzzyWuzzy works and how you can use it." />

<meta name="twitter:image:src" content="https://strikingloo.github.io/resources/post_image/fuzzyplant.jpeg" />
<meta property="og:image" content="https://strikingloo.github.io/resources/post_image/fuzzyplant.jpeg"/>

			
			</div>
			<footer>
	    		<ul>
	        		<li><a href="mailto:lucianostrika44@gmail.com" rel="me" title="email me">‚úâÔ∏è</a></li>
	        		<li><a href="https://github.com/strikingloo" rel="me noopener noreferrer nofollow" title="GitHub"><svg viewBox="0 0 438.549 438.549" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em"><path fill="#0F3D3E" d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289s4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136s11.704-.476 16.274-1.423c4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></svg></a></li>
			        <li><a href="https://twitter.com/intent/follow?screen_name=strikingloo" rel="me noopener noreferrer nofollow" title="twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 310 310" height="1em" width="1em"><path fill="#0F3D3E" d="M302.973 57.388a117.512 117.512 0 01-14.993 5.463 66.276 66.276 0 0013.494-23.73 5 5 0 00-7.313-5.824 117.994 117.994 0 01-34.878 13.783c-12.381-12.098-29.197-18.983-46.581-18.983-36.695 0-66.549 29.853-66.549 66.547 0 2.89.183 5.764.545 8.598C101.163 99.244 58.83 76.863 29.76 41.204a5.001 5.001 0 00-8.196.642c-5.896 10.117-9.013 21.688-9.013 33.461 0 16.035 5.725 31.249 15.838 43.137a56.37 56.37 0 01-8.907-3.977 5 5 0 00-7.427 4.257c-.007.295-.007.59-.007.889 0 23.935 12.882 45.484 32.577 57.229a57.372 57.372 0 01-5.063-.735 4.998 4.998 0 00-5.699 6.437c7.29 22.76 26.059 39.501 48.749 44.605-18.819 11.787-40.34 17.961-62.932 17.961a120.4 120.4 0 01-14.095-.826 5 5 0 00-3.286 9.174c29.023 18.609 62.582 28.445 97.047 28.445 67.754 0 110.139-31.95 133.764-58.753 29.46-33.421 46.356-77.658 46.356-121.367 0-1.826-.028-3.67-.084-5.508 11.623-8.757 21.63-19.355 29.773-31.536a5 5 0 00-6.182-7.351z"></path></svg></a></li>
			        <li><a href="http://www.linkedin.com/in/luciano-strika" rel="me noopener noreferrer nofollow" title="linkedin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 310 310" height="1em" width="1em"><path fill="#0F3D3E" d="M72.16 99.73H9.927a5 5 0 00-5 5v199.928a5 5 0 005 5H72.16a5 5 0 005-5V104.73a5 5 0 00-5-5zM41.066.341C18.422.341 0 18.743 0 41.362 0 63.991 18.422 82.4 41.066 82.4c22.626 0 41.033-18.41 41.033-41.038C82.1 18.743 63.692.341 41.066.341zM230.454 94.761c-24.995 0-43.472 10.745-54.679 22.954V104.73a5 5 0 00-5-5h-59.599a5 5 0 00-5 5v199.928a5 5 0 005 5h62.097a5 5 0 005-5V205.74c0-33.333 9.054-46.319 32.29-46.319 25.306 0 27.317 20.818 27.317 48.034v97.204a5 5 0 005 5H305a5 5 0 005-5V194.995c0-49.565-9.451-100.234-79.546-100.234z"></path></svg></a></li>
			        <li><a href="/resources/Luciano_Strika.pdf">CV</a></li>
				</ul>
				<p><i>Built with ‚ù§Ô∏è by <a href="https://strikingloo.github.io/">Strikingloo</a>.</i></p>
			</footer>
			

			

			
			<link rel="preload" href="/css/non-critical-post-min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
			<noscript><link rel="stylesheet" href="/css/non-critical-post-min.css"></noscript>
        	
		</body>
	</html>
